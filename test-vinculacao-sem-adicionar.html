<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste: Vincula√ß√£o sem bot√£o Adicionar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .simulation-panel {
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #f8f9fa;
        }
        .expansion-panel {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        .panel-header {
            background: #e9ecef;
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #ddd;
        }
        .panel-content {
            padding: 15px;
            display: none;
        }
        .panel-content.expanded {
            display: block;
        }
        .mat-select-mock {
            border: 1px solid #ddd;
            padding: 10px;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
            min-height: 40px;
            display: flex;
            align-items: center;
        }
        .mat-select-mock.disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
        }
        .dropdown {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            width: 300px;
            display: none;
        }
        .dropdown.show {
            display: block;
        }
        .dropdown-option {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        .dropdown-option:hover {
            background: #f8f9fa;
        }
        .dropdown-option:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste: Vincula√ß√£o OJ sem bot√£o "Adicionar"</h1>
        
        <div class="debug-info">
            <strong>Objetivo:</strong> Verificar se o c√≥digo modificado consegue encontrar e interagir com o campo de √ìrg√£o Julgador sem precisar clicar no bot√£o "Adicionar"
        </div>
        
        <div class="simulation-panel">
            <h3>üé≠ Simula√ß√£o da Interface PJE</h3>
            
            <!-- Acorde√£o de √ìrg√£os Julgadores -->
            <div class="expansion-panel">
                <div class="panel-header" id="panel-header-orgaos" 
                     aria-expanded="false" aria-controls="panel-content-orgaos"
                     onclick="togglePanel()">
                    üìÅ √ìrg√£os Julgadores vinculados ao Perito
                </div>
                <div class="panel-content" id="panel-content-orgaos">
                    
                    <!-- Campo de √ìrg√£o Julgador (sempre presente) -->
                    <div style="margin: 20px 0;">
                        <label for="orgao-julgador">√ìrg√£o Julgador:</label>
                        <div class="mat-select-mock" id="mat-select-orgao" 
                             aria-disabled="false" tabindex="0"
                             placeholder="√ìrg√£o Julgador"
                             onclick="openDropdown()">
                            Selecione um √ìrg√£o Julgador...
                        </div>
                        
                        <!-- Dropdown simulado -->
                        <div class="dropdown" id="orgao-dropdown">
                            <div class="dropdown-option" onclick="selectOption('Vara do Trabalho de Adamantina')">
                                Vara do Trabalho de Adamantina
                            </div>
                            <div class="dropdown-option" onclick="selectOption('Vara do Trabalho de Bauru')">
                                Vara do Trabalho de Bauru
                            </div>
                            <div class="dropdown-option" onclick="selectOption('Vara do Trabalho de Campinas')">
                                Vara do Trabalho de Campinas
                            </div>
                            <div class="dropdown-option" onclick="selectOption('Vara do Trabalho de Santos')">
                                Vara do Trabalho de Santos
                            </div>
                            <div class="dropdown-option" onclick="selectOption('Vara do Trabalho de S√£o Paulo')">
                                Vara do Trabalho de S√£o Paulo
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bot√£o de vincula√ß√£o -->
                    <button class="btn" onclick="simularVinculacao()" style="margin-top: 20px;">
                        Vincular √ìrg√£o Julgador ao Perito
                    </button>
                    
                    <!-- Tabela de v√≠nculos existentes -->
                    <div style="margin-top: 20px;">
                        <h4>OJs Vinculados:</h4>
                        <table style="width: 100%; border-collapse: collapse;" id="tabela-vinculos">
                            <thead>
                                <tr style="background: #e9ecef;">
                                    <th style="border: 1px solid #ddd; padding: 8px;">√ìrg√£o Julgador</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="vinculos-tbody">
                                <!-- V√≠nculos ser√£o adicionados aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="debug-info">
            <h3>üîç Testes Automatizados</h3>
            <button class="btn" onclick="testarBuscaCampo()">1. Testar Busca do Campo</button>
            <button class="btn" onclick="testarSelecao()">2. Testar Sele√ß√£o de OJ</button>
            <button class="btn" onclick="testarVinculacao()">3. Testar Vincula√ß√£o Completa</button>
            <button class="btn" onclick="limparTestes()">Limpar Resultados</button>
        </div>
        
        <div id="resultados-teste" class="debug-info">
            <strong>Resultados dos Testes:</strong>
            <div id="resultados-content">Nenhum teste executado ainda.</div>
        </div>
        
        <div class="debug-info">
            <h3>üìã Checklist de Funcionalidades</h3>
            <ul>
                <li id="check-expansao">‚ùì Expans√£o do acorde√£o sem clicar em "Adicionar"</li>
                <li id="check-campo">‚ùì Localiza√ß√£o do campo de √ìrg√£o Julgador</li>
                <li id="check-habilitado">‚ùì Verifica√ß√£o se campo est√° habilitado</li>
                <li id="check-dropdown">‚ùì Abertura do dropdown de op√ß√µes</li>
                <li id="check-selecao">‚ùì Sele√ß√£o de uma op√ß√£o espec√≠fica</li>
                <li id="check-vinculacao">‚ùì Execu√ß√£o da vincula√ß√£o</li>
                <li id="check-validacao">‚ùì Valida√ß√£o na tabela de v√≠nculos</li>
            </ul>
        </div>
    </div>

    <script>
        let selectedOJ = null;
        let testResults = [];
        
        function togglePanel() {
            const header = document.getElementById('panel-header-orgaos');
            const content = document.getElementById('panel-content-orgaos');
            const isExpanded = header.getAttribute('aria-expanded') === 'true';
            
            if (isExpanded) {
                header.setAttribute('aria-expanded', 'false');
                content.classList.remove('expanded');
                updateCheck('check-expansao', false, 'Acorde√£o foi fechado');
            } else {
                header.setAttribute('aria-expanded', 'true');
                content.classList.add('expanded');
                updateCheck('check-expansao', true, 'Acorde√£o expandido com sucesso');
            }
        }
        
        function openDropdown() {
            const dropdown = document.getElementById('orgao-dropdown');
            const isVisible = dropdown.classList.contains('show');
            
            if (isVisible) {
                dropdown.classList.remove('show');
            } else {
                dropdown.classList.add('show');
                updateCheck('check-dropdown', true, 'Dropdown aberto com sucesso');
            }
        }
        
        function selectOption(opcao) {
            selectedOJ = opcao;
            const selectElement = document.getElementById('mat-select-orgao');
            selectElement.textContent = opcao;
            
            const dropdown = document.getElementById('orgao-dropdown');
            dropdown.classList.remove('show');
            
            updateCheck('check-selecao', true, `Op√ß√£o selecionada: ${opcao}`);
        }
        
        function simularVinculacao() {
            if (!selectedOJ) {
                updateCheck('check-vinculacao', false, 'Nenhum OJ selecionado');
                return;
            }
            
            // Adicionar √† tabela
            const tbody = document.getElementById('vinculos-tbody');
            const row = tbody.insertRow();
            const cellOJ = row.insertCell(0);
            const cellAcoes = row.insertCell(1);
            
            cellOJ.style.border = '1px solid #ddd';
            cellOJ.style.padding = '8px';
            cellOJ.textContent = selectedOJ;
            
            cellAcoes.style.border = '1px solid #ddd';
            cellAcoes.style.padding = '8px';
            cellAcoes.innerHTML = '<button onclick="removerVinculo(this)" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px;">Remover</button>';
            
            updateCheck('check-vinculacao', true, `OJ "${selectedOJ}" vinculado com sucesso`);
            updateCheck('check-validacao', true, 'OJ apareceu na tabela de v√≠nculos');
            
            // Reset selection
            selectedOJ = null;
            document.getElementById('mat-select-orgao').textContent = 'Selecione um √ìrg√£o Julgador...';
        }
        
        function removerVinculo(button) {
            const row = button.closest('tr');
            row.remove();
        }
        
        function updateCheck(checkId, success, message) {
            const element = document.getElementById(checkId);
            if (success) {
                element.innerHTML = `‚úÖ ${message}`;
                element.style.color = '#155724';
            } else {
                element.innerHTML = `‚ùå ${message}`;
                element.style.color = '#721c24';
            }
        }
        
        function addTestResult(test, success, message) {
            testResults.push({
                test,
                success,
                message,
                timestamp: new Date().toLocaleTimeString()
            });
            updateTestResults();
        }
        
        function updateTestResults() {
            const content = document.getElementById('resultados-content');
            if (testResults.length === 0) {
                content.innerHTML = 'Nenhum teste executado ainda.';
                return;
            }
            
            let html = '';
            testResults.forEach(result => {
                const className = result.success ? 'success' : 'error';
                html += `<div class="${className}" style="margin: 5px 0; padding: 8px; border-radius: 4px;">
                    [${result.timestamp}] <strong>${result.test}:</strong> ${result.message}
                </div>`;
            });
            content.innerHTML = html;
        }
        
        function testarBuscaCampo() {
            // Simular busca do campo
            const campo = document.getElementById('mat-select-orgao');
            if (campo) {
                const disabled = campo.getAttribute('aria-disabled');
                const visible = campo.offsetParent !== null;
                
                if (visible && disabled !== 'true') {
                    updateCheck('check-campo', true, 'Campo encontrado e habilitado');
                    updateCheck('check-habilitado', true, 'Campo est√° pronto para intera√ß√£o');
                    addTestResult('Busca do Campo', true, 'Campo de √ìrg√£o Julgador encontrado e habilitado');
                } else {
                    updateCheck('check-campo', false, 'Campo encontrado mas est√° desabilitado ou invis√≠vel');
                    addTestResult('Busca do Campo', false, 'Campo encontrado mas n√£o est√° dispon√≠vel');
                }
            } else {
                updateCheck('check-campo', false, 'Campo n√£o encontrado');
                addTestResult('Busca do Campo', false, 'Campo de √ìrg√£o Julgador n√£o encontrado');
            }
        }
        
        function testarSelecao() {
            // Primeiro garantir que o acorde√£o est√° aberto
            const header = document.getElementById('panel-header-orgaos');
            const content = document.getElementById('panel-content-orgaos');
            
            if (header.getAttribute('aria-expanded') !== 'true') {
                togglePanel();
            }
            
            // Simular clique no campo
            openDropdown();
            
            // Simular sele√ß√£o de uma op√ß√£o
            setTimeout(() => {
                selectOption('Vara do Trabalho de Adamantina');
                addTestResult('Sele√ß√£o de OJ', true, 'Vara do Trabalho de Adamantina selecionada com sucesso');
            }, 500);
        }
        
        function testarVinculacao() {
            // Verificar se h√° uma sele√ß√£o
            if (!selectedOJ) {
                // Fazer sele√ß√£o automaticamente
                testarSelecao();
                setTimeout(() => {
                    simularVinculacao();
                    addTestResult('Vincula√ß√£o Completa', true, 'Processo de vincula√ß√£o conclu√≠do com sucesso');
                }, 1000);
            } else {
                simularVinculacao();
                addTestResult('Vincula√ß√£o Completa', true, 'Processo de vincula√ß√£o conclu√≠do com sucesso');
            }
        }
        
        function limparTestes() {
            testResults = [];
            updateTestResults();
            
            // Reset checkboxes
            const checks = ['check-expansao', 'check-campo', 'check-habilitado', 'check-dropdown', 'check-selecao', 'check-vinculacao', 'check-validacao'];
            checks.forEach(checkId => {
                const element = document.getElementById(checkId);
                element.innerHTML = element.innerHTML.replace(/‚úÖ|‚ùå/, '‚ùì');
                element.style.color = '';
            });
            
            // Reset selection
            selectedOJ = null;
            document.getElementById('mat-select-orgao').textContent = 'Selecione um √ìrg√£o Julgador...';
            
            // Clear table
            document.getElementById('vinculos-tbody').innerHTML = '';
        }
        
        // Auto-expandir o acorde√£o para demonstra√ß√£o
        window.addEventListener('load', () => {
            setTimeout(() => {
                togglePanel();
            }, 1000);
        });
    </script>
</body>
</html>